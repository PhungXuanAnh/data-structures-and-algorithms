<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVL Tree Right-Left (RL) Rotation Animation</title>
    <style>
        body {
            font-family: 'Source Sans Pro', sans-serif;
            margin: 20px;
        }

        .svgDataText {
            font-family: "Roboto Mono", monospace;
            fill: black;
            font-size: 20px;
            text-anchor: middle;
            dominant-baseline: middle;
        }

        .svgBalFac {
            font-family: "Roboto Mono", monospace;
            fill: black;
            font-size: 16px;
            opacity: 0;
        }

        .node {
            stroke: black;
            stroke-width: 1;
            fill: gainsboro;
        }

        .branch {
            stroke: black;
            stroke-width: 1;
            fill: black;
        }

        #arrowheadRed {
            stroke: red;
            fill: red;
        }

        #arrowhead line {
            stroke: black;
            fill: black;
        }

        .hidden-svg {
            position: absolute;
            left: -9999px;
            width: 0;
            height: 0;
        }

        .divAnim {
            display: inline-block;
            border: solid black 1px;
            margin: 20px 0;
            width: 367px;
            max-width: 100%;
        }

        .divAnim svg {
            width: 367px;
            max-width: 100%;
            height: auto;
        }

        .divAnim button {
            display: block;
            margin: 12px auto;
        }

        .divAnim line,
        .divAnim .arcLeft,
        .divAnim .arcRight {
            opacity: 0;
        }

        .redText {
            fill: red;
        }
    </style>
</head>

<body>
    <h2>The Right-Left (RL) Case</h2>
    <p>The Right-Left case is when the unbalanced node is right heavy, and its right child node is left heavy.</p>
    <p>In this case we first do a right rotation on the unbalanced node's right child, and then we do a left rotation on
        the unbalanced node itself.</p>
    <p>Step through the animation below to see how the Right-Left case can occur, and how rotations are done to restore
        the balance.</p>

    <!-- SVG Definitions for arrowheads -->
    <svg xmlns="http://www.w3.org/2000/svg" class="hidden-svg">
        <defs>
            <marker id="arrowhead" markerWidth="8" markerHeight="14" refX="0" refY="7" orient="auto"
                markerUnits="userSpaceOnUse">
                <line x1="0.5" y1="0.5" x2="7.5" y2="7.5" stroke-width="1.5"></line>
                <line x1="0" y1="7" x2="6" y2="7" stroke-width="1"></line>
                <line x1="0.5" y1="13.5" x2="7.5" y2="6.5" stroke-width="1.5"></line>
            </marker>
            <marker id="arrowheadRed" markerWidth="8" markerHeight="14" refX="0" refY="7" orient="auto"
                markerUnits="userSpaceOnUse">
                <line x1="0.5" y1="0.5" x2="7.5" y2="7.5" stroke-width="1.5"></line>
                <line x1="0" y1="7" x2="6" y2="7" stroke-width="1"></line>
                <line x1="0.5" y1="13.5" x2="7.5" y2="6.5" stroke-width="1.5"></line>
            </marker>
        </defs>
    </svg>

    <div id="divAnimRL" class="divAnim">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 440 220">
            <path d="M 4 17 A 30 30 0 0 1 51 11" fill="none" stroke="red" stroke-width="1" class="arcRight"
                transform="translate(188,1)" marker-end="url(#arrowheadRed)"
                style="transform: translateX(0px) translateY(0px); opacity: 0;"></path>
            <path d="M 56 17 A 30 30 0 0 0 9 11" fill="none" stroke="red" stroke-width="1" class="arcLeft"
                transform="translate(187,1)" marker-end="url(#arrowheadRed)" style="opacity: 0;"></path>

            <!-- '10' node (A) -->
            <g class="child leaf node10" style="transform: translateY(70px);">
                <text x="215" y="-52" class="svgBalFac" style="opacity: 1;">+1</text>
                <circle cx="215" cy="-30" r="20" class="node"></circle>
                <text x="215" y="-30" class="svgDataText">10</text>
            </g>

            <line x1="0" y1="0" x2="23" y2="20" class="branch line1" marker-end="url(#arrowhead)"
                style="transform: translateX(231px) translateY(52px); opacity: 1;"></line>

            <!-- '60' node (F) -->
            <g class="child leaf node60" style="transform: translateX(60px) translateY(120px);">
                <text x="215" y="-52" class="svgBalFac" style="opacity: 1;">0</text>
                <circle cx="215" cy="-30" r="20" class="node"></circle>
                <text x="215" y="-30" class="svgDataText">60</text>
            </g>

            <!-- '20' node (B) -->
            <g class="child leaf node20" style="transform: translateY(0px);">
                <text x="215" y="-52" class="svgBalFac" style="opacity: 0;">0</text>
                <circle cx="215" cy="-30" r="20" class="node"></circle>
                <text x="215" y="-30" class="svgDataText">20</text>
            </g>

            <line x1="23" y1="0" x2="0" y2="20" class="branch line2" marker-end="url(#arrowhead)"
                style="transform: translateX(0px) translateY(0px); opacity: 0;"></line>

            <!-- '80' node (G) -->
            <g class="child leaf node80" style="transform: translateY(0px);">
                <text x="215" y="-52" class="svgBalFac" style="opacity: 0;">0</text>
                <circle cx="215" cy="-30" r="20" class="node"></circle>
                <text x="215" y="-30" class="svgDataText">80</text>
            </g>

            <line x1="23" y1="0" x2="0" y2="20" class="branch line3" marker-end="url(#arrowhead)"
                style="transform: translateX(0px) translateY(0px); opacity: 0;"></line>

            <!-- '50' node (E) -->
            <g class="child leaf node50" style="transform: translateY(0px);">
                <text x="215" y="-52" class="svgBalFac" style="opacity: 0;">0</text>
                <circle cx="215" cy="-30" r="20" class="node"></circle>
                <text x="215" y="-30" class="svgDataText">50</text>
            </g>

            <line x1="23" y1="0" x2="0" y2="20" class="branch line4" marker-end="url(#arrowhead)"
                style="transform: translateX(0px) translateY(0px); opacity: 0;"></line>

            <!-- '40' node (D) -->
            <g class="child leaf node40" style="transform: translateY(0px);">
                <text x="215" y="-52" class="svgBalFac" style="opacity: 0;">0</text>
                <circle cx="215" cy="-30" r="20" class="node"></circle>
                <text x="215" y="-30" class="svgDataText">40</text>
            </g>

            <line x1="23" y1="0" x2="0" y2="20" class="branch line5" marker-end="url(#arrowhead)"
                style="transform: translateX(0px) translateY(0px); opacity: 0;"></line>

        </svg>
        <button onclick="tlRL.play()">Insert 20</button>
    </div>

    <p>After inserting node 20, we get a Right-Left case because node 10 becomes unbalanced and right heavy, and its
        right child is left heavy. To restore balance, a right rotation is first done on node 60, and then a left
        rotation is done on node 10.</p>
    <p>The next Right-Left case occurs after nodes 80, 50, and 40 are added. This is a Right-Left case because 20 is
        unbalanced and right heavy, and its right child 60 is left heavy. To restore balance, a right rotation is first
        done on node 60, and then a left rotation is done on node 20.</p>

    <!-- Anime.js library -->
    <script src="../DSA AVL Trees_files/anime.min.js"></script>

    <script>
        // Create timeline.
        // Put pause() after every new animation is done.
        // Button resumes the timeline by calling tlRL.play().
        let tlRL;
        let playBtnRL = document.querySelector('#divAnimRL button');

        tlRL = anime.timeline({
            autoplay: true,
            duration: 500,
            easing: 'easeInOutCirc',
            loop: false
        });

        tlRL.add({
            targets: '#divAnimRL .node10 .svgBalFac, #divAnimRL .node60 .svgBalFac',
            opacity: 1,
            duration: 10,
            complete: function (anim) {
                document.querySelectorAll('#divAnimRL .svgBalFac').forEach(function (element) {
                    element.innerHTML = '0';
                });
                document.querySelector('#divAnimRL .node10 .svgBalFac').innerHTML = "+1";
            }
        })
            .add({
                targets: '#divAnimRL .node10',
                translateY: 70,
                duration: 10
            })
            .add({
                targets: '#divAnimRL .line1',
                translateX: 231,
                translateY: 52,
                opacity: 1,
                x1: 0,
                x2: 23,
                duration: 10
            })
            .add({
                targets: '#divAnimRL .node60',
                translateX: 60,
                translateY: 120,
                duration: 10
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Insert 20';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                targets: '#divAnimRL .node20',
                translateY: 60,
                begin: function (anim) {
                    playBtnRL.disabled = true;
                }
            })
            .add({
                targets: '#divAnimRL .node20',
                translateX: 60,
                translateY: 110
            })
            .add({
                targets: '#divAnimRL .node20',
                translateX: 0,
                translateY: 170
            })
            .add({
                targets: '#divAnimRL .line2',
                translateX: 238,
                translateY: 103
            })
            .add({
                targets: '#divAnimRL .line2',
                opacity: 1
            })
            .add({
                targets: '#divAnimRL .node20 .svgBalFac',
                opacity: 1,
            })
            .add({
                targets: '#divAnimRL .node60 .svgBalFac',
                opacity: [0, 1],
                y: -50,
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node60 .svgBalFac').innerHTML = '-1';
                }
            })
            .add({
                targets: '#divAnimRL .node10 .svgBalFac',
                opacity: [0, 1],
                y: -50,
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node10 .svgBalFac').classList.add('redText');
                    document.querySelector('#divAnimRL .node10 .svgBalFac').innerHTML = '+2';
                }
            })
            .add({
                targets: '#divAnimRL .arcRight',
                translateX: 248,
                translateY: 51,
                duration: 10
            })
            .add({
                targets: '#divAnimRL .arcLeft, #divAnimRL .arcRight',
                opacity: 1
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Rotate Right-Left';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                targets: '#divAnimRL .arcRight',
                opacity: 0,
                begin: function (anim) {
                    playBtnRL.disabled = true;
                }
            })
            .add({
                targets: '#divAnimRL .node60',
                translateX: 120,
                translateY: 170,
                duration: 1000
            })
            .add({
                targets: '#divAnimRL .line2',
                translateX: 297,
                translateY: 105,
                y1: 20,
                y2: 0,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node20',
                translateX: 60,
                translateY: 120,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line2',
                translateX: 291,
                translateY: 102,
                x1: 0,
                x2: 23,
                y1: 0,
                y2: 20
            })
            .add({
                targets: '#divAnimRL .arcLeft',
                opacity: 0
            })
            .add({
                targets: '#divAnimRL .node10',
                translateX: -60,
                translateY: 120,
                duration: 1000
            })
            .add({
                targets: '#divAnimRL .line1',
                translateX: 170,
                translateY: 57,
                y1: 20,
                y2: 0,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node20',
                translateX: 0,
                translateY: 70,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line2',
                translateX: 231,
                translateY: 52,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node60',
                translateX: 60,
                translateY: 120,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node60 .svgBalFac, #divAnimRL .node10 .svgBalFac',
                y: -52,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line1',
                translateX: 177,
                translateY: 53,
                x1: 23,
                x2: 0,
                y1: 0,
                y2: 20
            })
            .add({
                targets: '#divAnimRL .node10 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node10 .svgBalFac').classList.remove('redText');
                    document.querySelector('#divAnimRL .node10 .svgBalFac').innerHTML = '0';
                }
            })
            .add({
                targets: '#divAnimRL .node60 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node60 .svgBalFac').innerHTML = '0';
                }
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Insert 80';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                targets: '#divAnimRL .node80',
                translateY: 60,
                begin: function (anim) {
                    playBtnRL.disabled = true;
                }
            })
            .add({
                targets: '#divAnimRL .node80',
                translateX: 60,
                translateY: 110
            })
            .add({
                targets: '#divAnimRL .node80',
                translateX: 120,
                translateY: 170
            })
            .add({
                targets: '#divAnimRL .line3',
                translateX: 231 + 60,
                translateY: 52 + 50,
                x1: 0,
                x2: 23,
                duration: 10
            })
            .add({
                targets: '#divAnimRL .line3',
                opacity: 1
            })
            .add({
                targets: '#divAnimRL .node80 .svgBalFac',
                opacity: 1
            })
            .add({
                targets: '#divAnimRL .node60 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node60 .svgBalFac').innerHTML = '+1';
                }
            })
            .add({
                targets: '#divAnimRL .node20 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node20 .svgBalFac').innerHTML = '+1';
                }
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Insert 50';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                targets: '#divAnimRL .node50',
                translateY: 60,
                begin: function (anim) {
                    playBtnRL.disabled = true;
                }
            })
            .add({
                targets: '#divAnimRL .node50',
                translateX: 60,
                translateY: 110
            })
            .add({
                targets: '#divAnimRL .node50',
                translateX: 0,
                translateY: 170
            })
            .add({
                targets: '#divAnimRL .line4',
                translateX: 238,
                translateY: 103,
                duration: 10
            })
            .add({
                targets: '#divAnimRL .line4',
                opacity: 1,
            })
            .add({
                targets: '#divAnimRL .node50 .svgBalFac',
                opacity: 1,
            })
            .add({
                targets: '#divAnimRL .node60 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node60 .svgBalFac').innerHTML = '0';
                }
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Insert 40';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                targets: '#divAnimRL .node40',
                translateY: 60,
                begin: function (anim) {
                    playBtnRL.disabled = true;
                }
            })
            .add({
                targets: '#divAnimRL .node40',
                translateX: 60,
                translateY: 110
            })
            .add({
                targets: '#divAnimRL .node40',
                translateX: 0,
                translateY: 160
            })
            .add({
                targets: '#divAnimRL .node40',
                translateX: -60,
                translateY: 220
            })
            .add({
                targets: '#divAnimRL .line5',
                translateX: 178,
                translateY: 153,
                duration: 10
            })
            .add({
                targets: '#divAnimRL .line5',
                opacity: 1,
            })
            .add({
                targets: '#divAnimRL .node40 .svgBalFac',
                opacity: 1,
            })
            .add({
                targets: '#divAnimRL .node50 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node50 .svgBalFac').innerHTML = '-1';
                }
            })
            .add({
                targets: '#divAnimRL .node60 .svgBalFac',
                opacity: [0, 1],
                y: -50,
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node60 .svgBalFac').innerHTML = '-1';
                }
            })
            .add({
                targets: '#divAnimRL .node20 .svgBalFac',
                opacity: [0, 1],
                y: -50,
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node20 .svgBalFac').classList.add('redText');
                    document.querySelector('#divAnimRL .node20 .svgBalFac').innerHTML = '+2';
                }
            })
            .add({
                targets: '#divAnimRL .arcLeft, #divAnimRL .arcRight',
                opacity: 1
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Rotate Right-Left';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                targets: '#divAnimRL .arcRight',
                opacity: 0,
                begin: function (anim) {
                    playBtnRL.disabled = true;
                }
            })
            .add({
                targets: '#divAnimRL .node80',
                translateX: 180,
                translateY: 220,
                duration: 1000
            })
            .add({
                targets: '#divAnimRL .line3',
                translateX: 351,
                translateY: 152,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node60',
                translateX: 120,
                translateY: 170,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line4',
                translateX: 297,
                translateY: 105,
                y1: 20,
                y2: 0,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node50',
                translateX: 60,
                translateY: 120,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line5',
                translateX: 238,
                translateY: 103,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node40',
                translateX: 0,
                translateY: 170,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line4',
                translateX: 291,
                translateY: 102,
                x1: 0,
                x2: 23,
                y1: 0,
                y2: 20
            })
            .add({
                targets: '#divAnimRL .arcLeft',
                opacity: 0
            })
            .add({
                targets: '#divAnimRL .node10',
                translateX: -120,
                translateY: 170,
                duration: 1000
            })
            .add({
                targets: '#divAnimRL .line1',
                translateX: 117,
                translateY: 103,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node20',
                translateX: -60,
                translateY: 120,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line2',
                translateX: 170,
                translateY: 57,
                y1: 20,
                y2: 0,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node50',
                translateX: 0,
                translateY: 70,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line4',
                translateX: 231,
                translateY: 52,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node60',
                translateX: 60,
                translateY: 120,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line3',
                translateX: 291,
                translateY: 102,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line5',
                translateX: 170,
                x1: 0,
                x2: 23,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .node80',
                translateX: 120,
                translateY: 170,
                duration: 1000
            }, '-=1000')
            .add({
                targets: '#divAnimRL .line2',
                translateX: 177,
                translateY: 53,
                x1: 23,
                x2: 0,
                y1: 0,
                y2: 20
            })
            .add({
                targets: '#divAnimRL .node20 .svgBalFac',
                opacity: [0, 1],
                y: -52,
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node20 .svgBalFac').classList.remove('redText');
                    document.querySelector('#divAnimRL .node20 .svgBalFac').innerHTML = '0';
                }
            })
            .add({
                targets: '#divAnimRL .node50 .svgBalFac',
                opacity: [0, 1],
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node50 .svgBalFac').innerHTML = '0';
                }
            })
            .add({
                targets: '#divAnimRL .node60 .svgBalFac',
                opacity: [0, 1],
                y: -52,
                begin: function (anim) {
                    document.querySelector('#divAnimRL .node60 .svgBalFac').innerHTML = '+1';
                }
            })
            .add({
                complete: function (anim) {
                    playBtnRL.innerHTML = 'Reset';
                    playBtnRL.disabled = false;
                    tlRL.pause();
                }
            })
            .add({
                begin: function (anim) {
                    tlRL.restart();
                }
            });
    </script>
</body>

</html>